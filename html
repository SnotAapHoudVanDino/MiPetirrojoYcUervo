<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geheime Website</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js"></script>
    <style>
        body {
            font-family: "Courier New", monospace;
            background: linear-gradient(to right, #ff4d6d, #ff758f);
            text-align: center;
            color: white;
        }
        .hidden {
            display: none;
        }
        .container {
            margin-top: 50px;
        }
        button {
            background-color: #ff4d6d;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            color: white;
        }
        button:hover {
            background-color: #ff1e45;
        }
        textarea {
            width: 80%;
            height: 150px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div id="login">
        <h2>Voer de toegangscode in:</h2>
        <input type="password" id="codeInput">
        <button onclick="checkCode()">Inloggen</button>
    </div>

    <div id="mainContent" class="hidden">
        <h1>Welkom!</h1>
        <button onclick="showDiary()">Dagboek</button>
        <button onclick="showMedia()">Foto’s & Video’s</button>

        <div id="diarySection" class="hidden">
            <h2>Dagboek</h2>
            <textarea id="diaryText" placeholder="Schrijf hier je gedachten..."></textarea>
            <button onclick="saveDiary()">Opslaan</button>
            <div id="savedDiary"></div>
        </div>

        <div id="mediaSection" class="hidden">
            <h2>Foto’s & Video’s</h2>
            <button onclick="showCategory('zomaar')">Zomaar Jij en Ik</button>
            <button onclick="showCategory('zomervakantie')">Zomervakantie</button>
            <button onclick="showCategory('kerstvakantie')">Kerstvakantie</button>
            <button onclick="showCategory('opreis')">Op Reis</button>
            <input type="file" id="fileUpload" multiple>
            <button onclick="uploadFile()">Upload</button>
            <div id="mediaContent"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAmBFtPf11eu4tohfj17CMkG8FbsVl93O8",
            authDomain: "mijnroodborststje.firebaseapp.com",
            projectId: "mijnroodborststje",
            storageBucket: "mijnroodborststje.appspot.com",
            messagingSenderId: "99812857188",
            appId: "1:99812857188:web:f7b3dd2662dd70bca59671",
            measurementId: "G-V1HHCF8Y93"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        function checkCode() {
            const code = document.getElementById("codeInput").value;
            if (code === "28/08/2024") {
                alert("Ik hou van jou, Robin ❤️");
                document.getElementById("login").classList.add("hidden");
                document.getElementById("mainContent").classList.remove("hidden");
                loadDiary();
                loadMedia();
            } else {
                alert("Foute code! Probeer opnieuw.");
            }
        }

        function showDiary() {
            document.getElementById("diarySection").classList.toggle("hidden");
        }

        function saveDiary() {
            const text = document.getElementById("diaryText").value;
            if (text) {
                db.collection("diary").add({ text: text, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
                document.getElementById("diaryText").value = "";
            }
        }

        function loadDiary() {
            db.collection("diary").orderBy("timestamp", "desc").onSnapshot(snapshot => {
                document.getElementById("savedDiary").innerHTML = "";
                snapshot.forEach(doc => {
                    document.getElementById("savedDiary").innerHTML += `<p>${doc.data().text}</p>`;
                });
            });
        }

        function showMedia() {
            document.getElementById("mediaSection").classList.toggle("hidden");
        }

        function uploadFile() {
            const files = document.getElementById("fileUpload").files;
            if (files.length > 0) {
                Array.from(files).forEach(file => {
                    const storageRef = storage.ref("uploads/" + file.name);
                    storageRef.put(file).then(snapshot => {
                        snapshot.ref.getDownloadURL().then(url => {
                            db.collection("media").add({
                                url: url,
                                timestamp: firebase.firestore.FieldValue.serverTimestamp()
                            });
                        });
                    });
                });
            }
        }

        function loadMedia() {
            db.collection("media").orderBy("timestamp", "desc").onSnapshot(snapshot => {
                document.getElementById("mediaContent").innerHTML = "";
                snapshot.forEach(doc => {
                    const url = doc.data().url;
                    const extension = url.split('.').pop().toLowerCase();

                    if (extension === 'mp4') {  // Als het bestand een video is
                        document.getElementById("mediaContent").innerHTML += `<video width="200" controls><source src="${url}" type="video/mp4">Your browser does not support the video tag.</video>`;
                    } else {  // Anders, ga ervan uit dat het een afbeelding is
                        document.getElementById("mediaContent").innerHTML += `<img src="${url}" width="200">`;
                    }
                });
            });
        }
    </script>
</body>
</html>
